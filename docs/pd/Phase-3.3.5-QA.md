# Phase 3.3.5-Pro QA Checklist

## 🎯 Phase 3.3.5: Persistent Session & Auto Restore Modal

**목적**: 세션 유지 및 자동 복원으로 사용자 경험 향상

---

## ✅ 기능 테스트

### 1. 세션 지속성 (Persistent Session)

| 테스트 항목 | 절차 | 예상 결과 | 상태 |
|------------|------|-----------|------|
| 새로고침 후 로그인 유지 | 1. 로그인<br>2. F5 새로고침 | 로그인 상태 유지, 대시보드 표시 | ⬜ |
| 탭 종료 후 재접속 | 1. 로그인<br>2. 탭 종료<br>3. 재접속 | 로그인 상태 유지 | ⬜ |
| 브라우저 재시작 | 1. 로그인<br>2. 브라우저 완전 종료<br>3. 재시작 후 접속 | 로그인 상태 유지 | ⬜ |

### 2. 자동 세션 복원 (Auto Restore)

| 테스트 항목 | 절차 | 예상 결과 | 상태 |
|------------|------|-----------|------|
| 탭 복귀 시 세션 확인 | 1. 로그인<br>2. 다른 탭으로 이동 (1분 대기)<br>3. 원래 탭 복귀 | 세션 상태 자동 확인 | ⬜ |
| 세션 복원 성공 | 1. 로그인<br>2. 10분 이상 대기<br>3. 탭 복귀 | "세션 복원 중..." 모달 → "복원 완료!" | ⬜ |
| 세션 복원 실패 | 1. 로그인<br>2. 토큰 수동 삭제 (DevTools)<br>3. 탭 복귀 | "세션 만료" 모달 → 로그인 페이지 이동 | ⬜ |

### 3. 모달 UX (Modal User Experience)

| 테스트 항목 | 절차 | 예상 결과 | 상태 |
|------------|------|-----------|------|
| 복원 중 모달 표시 | 세션 복원 트리거 | 반투명 배경 + 로딩 스피너 + "세션 복원 중" 메시지 | ⬜ |
| 성공 모달 표시 | 복원 성공 시 | 초록색 체크 아이콘 + "복원 완료" 메시지 (2초 표시) | ⬜ |
| 실패 모달 표시 | 복원 실패 시 | 빨간색 경고 아이콘 + "만료" 메시지 (2초 후 리디렉션) | ⬜ |
| 모달 애니메이션 | 모달 등장/퇴장 | 부드러운 fade-in/out + scale 효과 | ⬜ |

### 4. 라우트 보호 (Route Protection)

| 테스트 항목 | 절차 | 예상 결과 | 상태 |
|------------|------|-----------|------|
| 로그인 없이 접근 | 1. 로그아웃 상태<br>2. `/admin/dashboard` 직접 접근 | `/auth/login`으로 리디렉션 | ⬜ |
| 권한 없는 페이지 접근 | 1. staff 계정 로그인<br>2. `/admin/dashboard` 접근 | `/agency/profile`로 리디렉션 | ⬜ |
| 로그인 페이지 자동 이동 | 1. 로그인 상태<br>2. `/auth/login` 접근 | role에 따라 대시보드로 자동 이동 | ⬜ |

---

## 🔧 기술 검증

### 1. Supabase 설정

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| Refresh Token Rotation | ON 설정 확인 | ⬜ |
| JWT Expiry | 3600초 이상 설정 | ⬜ |
| Auto Refresh | Enable automatic token refresh 체크 | ⬜ |

### 2. 코드 품질

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| TypeScript 타입 안전성 | 모든 컴포넌트 타입 정의 | ⬜ |
| 에러 핸들링 | try-catch 구문 적용 | ⬜ |
| 로깅 | console.log 적절히 사용 | ⬜ |
| 메모리 누수 방지 | useEffect cleanup 함수 구현 | ⬜ |

### 3. 성능

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| 불필요한 재렌더링 방지 | SessionSyncManager 최적화 | ⬜ |
| 로그인 페이지 제외 | auth 페이지에서 세션 체크 스킵 | ⬜ |
| 네트워크 요청 최소화 | 탭 복귀 시에만 체크 | ⬜ |

---

## 🎨 UI/UX 검증

### 1. 시각적 요소

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| 모달 디자인 | 카드 스타일, 그림자, 라운드 모서리 | ⬜ |
| 다크모드 지원 | bg-card, text-foreground 사용 | ⬜ |
| 아이콘 크기 | h-12 w-12, 적절한 색상 | ⬜ |
| 타이포그래피 | 제목: text-lg font-semibold<br>설명: text-sm text-muted-foreground | ⬜ |

### 2. 애니메이션

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| 모달 등장 | fade-in + scale-up (spring 효과) | ⬜ |
| 모달 퇴장 | fade-out + scale-down | ⬜ |
| 로딩 스피너 | 부드러운 회전 애니메이션 | ⬜ |

### 3. 접근성 (Accessibility)

| 항목 | 확인 내용 | 상태 |
|------|----------|------|
| 스크린 리더 지원 | aria-label, role 속성 (필요 시) | ⬜ |
| 키보드 네비게이션 | Esc 키로 모달 닫기 (필요 시) | ⬜ |
| 색상 대비 | WCAG 2.1 AA 기준 충족 | ⬜ |

---

## 🔍 Edge Case 테스트

### 1. 네트워크 상태

| 시나리오 | 절차 | 예상 결과 | 상태 |
|----------|------|-----------|------|
| 오프라인 상태 | 1. 로그인<br>2. 네트워크 차단<br>3. 탭 복귀 | 적절한 에러 메시지 표시 | ⬜ |
| 느린 네트워크 | 1. 로그인<br>2. 네트워크 3G 시뮬레이션<br>3. 탭 복귀 | 로딩 상태 유지, 타임아웃 없음 | ⬜ |

### 2. 동시 탭

| 시나리오 | 절차 | 예상 결과 | 상태 |
|----------|------|-----------|------|
| 여러 탭에서 로그인 | 1. 탭 A에서 로그인<br>2. 탭 B 열기 | 두 탭 모두 로그인 상태 | ⬜ |
| 한 탭에서 로그아웃 | 1. 탭 A, B 모두 로그인<br>2. 탭 A에서 로그아웃 | 탭 B도 자동 로그아웃 (이벤트 동기화) | ⬜ |

### 3. 시간 경계

| 시나리오 | 절차 | 예상 결과 | 상태 |
|----------|------|-----------|------|
| JWT 만료 직전 | JWT 만료 5초 전 탭 복귀 | 정상 복원 | ⬜ |
| JWT 만료 직후 | JWT 만료 5초 후 탭 복귀 | 복원 시도 → 로그인 페이지 | ⬜ |

---

## 🐛 버그 체크리스트

| 버그 시나리오 | 재현 절차 | 수정 확인 | 상태 |
|--------------|----------|-----------|------|
| 로그인 페이지에서 무한 리디렉션 | `/auth/login` 접속 시 | isAuthPage 체크로 방지 | ⬜ |
| 모달 중첩 표시 | 빠른 탭 전환 | 상태 관리로 방지 | ⬜ |
| 메모리 누수 | 컴포넌트 언마운트 후 | cleanup 함수로 리스너 제거 | ⬜ |
| 다크모드 깨짐 | 테마 변경 시 | semantic color 사용 | ⬜ |

---

## 📱 크로스 브라우저 테스트

| 브라우저 | 버전 | 세션 유지 | 자동 복원 | 모달 표시 | 상태 |
|---------|------|-----------|-----------|-----------|------|
| Chrome | 최신 | ⬜ | ⬜ | ⬜ | ⬜ |
| Firefox | 최신 | ⬜ | ⬜ | ⬜ | ⬜ |
| Safari | 최신 | ⬜ | ⬜ | ⬜ | ⬜ |
| Edge | 최신 | ⬜ | ⬜ | ⬜ | ⬜ |

---

## 📊 성능 측정

| 지표 | 목표 | 실제 | 상태 |
|------|------|------|------|
| 세션 확인 시간 | < 200ms | ___ ms | ⬜ |
| 복원 시도 시간 | < 1000ms | ___ ms | ⬜ |
| 모달 렌더링 시간 | < 100ms | ___ ms | ⬜ |
| 메모리 사용량 증가 | < 5MB | ___ MB | ⬜ |

---

## 🚀 배포 전 최종 체크

- [ ] 모든 기능 테스트 통과
- [ ] Edge case 테스트 완료
- [ ] 크로스 브라우저 테스트 완료
- [ ] 성능 기준 충족
- [ ] Supabase 설정 확인
- [ ] 문서 업데이트 (SESSION_MANAGEMENT.md)
- [ ] 로그 레벨 조정 (production)
- [ ] 에러 추적 설정 (Sentry 등)

---

## 📝 테스트 실행 기록

**테스터**: _____________  
**일자**: _____________  
**환경**: 
- OS: _____________
- 브라우저: _____________
- 네트워크: _____________

**발견된 이슈**:
1. _____________________________________________
2. _____________________________________________
3. _____________________________________________

**추가 의견**:
_____________________________________________
_____________________________________________

---

## ✨ Phase 완료 조건

모든 항목이 체크되면 Phase 3.3.5 완료로 간주합니다:

- [ ] 기능 테스트 100% 통과
- [ ] 기술 검증 모든 항목 확인
- [ ] UI/UX 검증 완료
- [ ] Edge Case 테스트 완료
- [ ] 크로스 브라우저 테스트 완료
- [ ] 성능 기준 충족
- [ ] 배포 전 체크리스트 완료
